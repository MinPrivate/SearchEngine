jQuery.cookie = function (name, value, options) { if (typeof value != "undefined") { options = options || {}; if (value === null) { value = ""; options.expires = -1 } var expires = ""; if (options.expires && (typeof options.expires == "number" || options.expires.toUTCString)) { var date; if (typeof options.expires == "number") { date = new Date(); date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000)) } else { date = options.expires } expires = "; expires=" + date.toUTCString() } var path = options.path ? "; path=" + (options.path) : ""; var domain = options.domain ? "; domain=" + (options.domain) : ""; var secure = options.secure ? "; secure" : ""; document.cookie = [name, "=", encodeURIComponent(value), expires, path, domain, secure].join("") } else { var cookieValue = null; if (document.cookie && document.cookie != "") { var cookies = document.cookie.split(";"); for (var i = 0; i < cookies.length; i++) { var cookie = jQuery.trim(cookies[i]); if (cookie.substring(0, name.length + 1) == (name + "=")) { cookieValue = decodeURIComponent(cookie.substring(name.length + 1)); break } } } return cookieValue } };
$(function ($) { backTop = function (btnId) { var btn = document.getElementById(btnId); var d = document.documentElement; var b = document.body; window.onscroll = set; btn.style.display = "none"; btn.onclick = function () { btn.style.display = "none"; window.onscroll = null; this.timer = setInterval(function () { d.scrollTop -= Math.ceil((d.scrollTop + b.scrollTop) * 0.1); b.scrollTop -= Math.ceil((d.scrollTop + b.scrollTop) * 0.1); if ((d.scrollTop + b.scrollTop) == 0) { clearInterval(btn.timer, window.onscroll = set) } }, 10) }; function set() { btn.style.display = (d.scrollTop + b.scrollTop > 100) ? "block" : "none" } }; backTop("GoTop") });
function ToolTip(msg, type, outTime) { $(".msgbox").remove(); $("body").append('<div class="msgbox"></div>'); $msgbox = $(".msgbox"); switch (type) { case "ok": $msgbox.addClass("msgsuc"); case "err": $msgbox.addClass("msgfai"); default: $msgbox.addClass("msgfai") } $msgbox.html(msg); $msgbox.css("margin-left", -($msgbox.width() / 2)); $msgbox.show(); $msgbox.animate({ top: "30%" }, 700); setTimeout(function () { $msgbox.fadeOut(1500); $msgbox.remove() }, outTime) }
function getip(gu, sk) { $.ajax({ url: "/home/biz/bizs.aspx", type: "GET", dataType: "xml", timeout: 5000, cache: false, data: "gu=" + gu + "&sk=" + sk, error: function () { }, success: function (xml) { } }) }
function iptime(gu, sk) { setTimeout(function () { getip(gu, sk) }, 3000) };
function loadCss(file) { var head = document.getElementsByTagName('head').item(0); css = document.createElement('link'); css.href = file; css.rel = 'stylesheet'; css.type = 'text/css'; css.id = 'loadCss'; head.appendChild(css); }